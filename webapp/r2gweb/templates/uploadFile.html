<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rest2Graph</title>

    <!-- Favicon -->
    <link rel="icon" href="/static/images/logo.png" type="image/png">

    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/uploadFile.css">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
          crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script type="text/javascript" src="/static/js/uploadFile.js"></script>


</head>
<body>
<header id="header" style="position: sticky; z-index:100; top: 0; width: 100%">
    <nav>
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                <img class="nav-log" src="/static/images/logo.png">
            </a>
        </div>
    </nav>
</header>

<div class="container">
    <div class="server-title">
        <h1>URL de los servidores</h1>
    </div>
    <div class="list-container">
        <form id="form-servers">

            {% for server in OpenAPI.servers %}
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="url" id="server1" checked>
                    <label class="form-check-label" for="server1"> {{ server }}</label>
                </div>
            {% endfor %}
        </form>
    </div>

    <div class="server-title">
        <h1>Métodos GET</h1>
    </div>

    <div>
        <form>
            <div id="form-gets" class="list-container">
                <!--Aquí se empieza de cada método-->
                {% for query in OpenAPI.queries %}
                    <div class="form-check d-flex justify-content-center align-items-center" id="q-{{ query.name }}">
                        <input class="form-check-input" type="checkbox" name="" id="get-{{ loop.index }}" checked>
                        <label class="form-check-label name-method w-100" id="get-label-{{ loop.index }}"
                               for="get-{{ loop.index }}">
                            <div class="mehtod-info d-flex justify-content-between align-items-center">
                                <div class="method" id="method-get-{{ loop.index }}">{{ query.name }}</div>
                                <div class="url" id="url-get-{{ loop.index }}"> {{ query.url }}</div>
                                <button class="edit-btn" type="button" data-bs-toggle="modal"
                                        data-bs-target="#get-edit-modal-{{ loop.index }}">
                                    <img class="img-edit" src="/static/images/icons8-editar-64.png">
                                </button>
                                <div class="modal fade" id="get-edit-modal-{{ loop.index }}" tabindex="-1"
                                     aria-labelledby="edit-modal" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-body" id="get-edit-modal-{{ loop.index }}-body">
                                                <h1 class="modal-edit-title">Cambie las propiedades del método:</h1>
                                                <form id="formq-{{ query.name }}">
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-name-{{ loop.index }}">Nombre del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="gets-method-name-{{ loop.index }}" placeholder=""
                                                               value="{{ query.name }}">
                                                    </div>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-url-{{ loop.index }}">URL del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="gets-method-url-{{ loop.index }}" placeholder=""
                                                               value="{{ query.url }}">
                                                    </div>
                                                    <div class="row"
                                                         style="text-align: center !important; margin-top: 20px;">
                                                        <div class="col">
                                                            <button class="save-button"
                                                                    onclick="changeObject('get',{{ loop.index }})"
                                                                    type="button">Guardar
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>
                {% endfor %}

            </div>
            <div class="server-title">
                <h1>Métodos POST</h1>
            </div>
            <div id="form-post" class="list-container">
                <!--Aquí se empieza de cada método-->
                {% for post in posts %}
                    <div class="form-check d-flex justify-content-center align-items-center">
                        <input class="form-check-input" type="checkbox" name="" id="post-{{ loop.index }}" checked>
                        <label class="form-check-label name-method w-100" id="post-label-{{ loop.index }}"
                               for="post-{{ loop.index }}">
                            <div class="mehtod-info d-flex justify-content-between align-items-center">
                                <div class="method" id="method-post-{{ loop.index }}">{{ post.name }}</div>
                                <div class="url" id="url-post-{{ loop.index }}"> {{ post.url }}</div>
                                <button class="edit-btn" type="button" data-bs-toggle="modal"
                                        data-bs-target="#post-edit-modal-{{ loop.index }}">
                                    <img class="img-edit" src="/static/images/icons8-editar-64.png">
                                </button>
                                <div class="modal fade" id="post-edit-modal-{{ loop.index }}" tabindex="-1"
                                     aria-labelledby="edit-modal" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-body" id="post-edit-modal-{{ loop.index }}-body">
                                                <h1 class="modal-edit-title">Cambie las propiedades del método:</h1>
                                                <form>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-name-{{ loop.index }}">Nombre del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="posts-method-name-{{ loop.index }}" placeholder=""
                                                               value="{{ post.name }}">
                                                    </div>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-url-{{ loop.index }}">URL del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="posts-method-url-{{ loop.index }}" placeholder=""
                                                               value="{{ post.url }}">
                                                    </div>
                                                    <div class="row"
                                                         style="text-align: center !important; margin-top: 20px;">
                                                        <div class="col">
                                                            <button class="save-button"
                                                                    onclick="changeObject('post', {{ loop.index }})"
                                                                    type="button">Guardar
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                                <div class="container">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>
                {% endfor %}
            </div>
            <div class="server-title">
                <h1>Métodos PUTS</h1>
            </div>
            <div id="form-puts" class="list-container">
                <!--Aquí se empieza de cada método-->
                {% for put in puts %}
                    <div class="form-check d-flex justify-content-center align-items-center">
                        <input class="form-check-input" type="checkbox" name="" id="put-{{ loop.index }}" checked>
                        <label class="form-check-label name-method w-100" id="put-label-{{ loop.index }}"
                               for="get-{{ loop.index }}">
                            <div class="mehtod-info d-flex justify-content-between align-items-center">
                                <div class="method" id="method-put-{{ loop.index }}">{{ put.name }}</div>
                                <div class="url" id="url-put-{{ loop.index }}"> {{ put.url }}</div>
                                <button class="edit-btn" type="button" data-bs-toggle="modal"
                                        data-bs-target="#puts-edit-modal-{{ loop.index }}">
                                    <img class="img-edit" src="/static/images/icons8-editar-64.png">
                                </button>
                                <div class="modal fade" id="puts-edit-modal-{{ loop.index }}" tabindex="-1"
                                     aria-labelledby="edit-modal" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-body" id="puts-edit-modal-{{ loop.index }}-body">
                                                <h1 class="modal-edit-title">Cambie las propiedades del método:</h1>
                                                <form>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-name-{{ loop.index }}">Nombre del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="puts-method-name-{{ loop.index }}" placeholder=""
                                                               value="{{ put.name }}">
                                                    </div>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-url-{{ loop.index }}">URL del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="puts-method-url-{{ loop.index }}" placeholder=""
                                                               value="{{ put.url }}">
                                                    </div>
                                                    <div class="row"
                                                         style="text-align: center !important; margin-top: 20px;">
                                                        <div class="col">
                                                            <button class="save-button"
                                                                    onclick="changeObject('put', {{ loop.index }})"
                                                                    type="button">Guardar
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>
                {% endfor %}
            </div>
            <div class="server-title">
                <h1>Métodos DELETES</h1>
            </div>
            <div id="form-deletes" class="list-container">
                <!--Aquí se empieza de cada método-->
                {% for delete in deletes %}
                    <div class="form-check d-flex justify-content-center align-items-center">
                        <input class="form-check-input" type="checkbox" name="" id="delete-{{ loop.index }}" checked>
                        <label class="form-check-label name-method w-100" id="delete-label-{{ loop.index }}"
                               for="delete-{{ loop.index }}">
                            <div class="mehtod-info d-flex justify-content-between align-items-center">
                                <div class="method" id="method-delete-{{ loop.index }}">{{ delete.name }}</div>
                                <div class="url" id="url-delete-{{ loop.index }}"> {{ delete.url }}</div>
                                <button class="edit-btn" type="button" data-bs-toggle="modal"
                                        data-bs-target="#deletes-edit-modal-{{ loop.index }}">
                                    <img class="img-edit" src="/static/images/icons8-editar-64.png">
                                </button>
                                <div class="modal fade" id="deletes-edit-modal-{{ loop.index }}" tabindex="-1"
                                     aria-labelledby="edit-modal" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-lg">
                                        <div class="modal-content">
                                            <div class="modal-body" id="deletes-edit-modal-{{ loop.index }}-body">
                                                <h1 class="modal-edit-title">Cambie las propiedades del método:</h1>
                                                <form>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-name-{{ loop.index }}">Nombre del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="deletes-method-name-{{ loop.index }}" placeholder=""
                                                               value="{{ delete.name }}">
                                                    </div>
                                                    <div class="input-text-method-info">
                                                        <label class="title-text"
                                                               for="deletes-method-url-{{ loop.index }}">URL del
                                                            método:</label>
                                                        <input type="text" class="form-control schema-name"
                                                               id="deletes-method-url-{{ loop.index }}" placeholder=""
                                                               value="{{ delete.url }}">
                                                    </div>
                                                    <div class="row"
                                                         style="text-align: center !important; margin-top: 20px;">
                                                        <div class="col">
                                                            <button class="save-button"
                                                                    onclick="changeObject('delete', {{ loop.index }})"
                                                                    type="button">Guardar
                                                            </button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>
                {% endfor %}
            </div>

            <div class="server-title">
                <h1>Schemas</h1>
            </div>
            <div id="form-schemas" class="list-container">
                <!--Aquí se empieza de cada método-->
                {% for schema in schemas %}
                    {% set parent_index = loop.index %}
                    <div class="form-check d-flex justify-content-center align-items-center"
                         id="div-schema-{{ parent_index }}">
                        <input class="form-check-input" type="checkbox" name="" id="schema{{ parent_index }}" checked>
                        <label id="label2-schema" class="form-check-label name-method w-100"
                               for="schema{{ parent_index }}">
                            <div class="mehtod-info d-flex justify-content-between align-items-center">
                                <div id="label-schema-{{ parent_index }}" class="method">{{ schema.name }}</div>
                                <button class="edit-btn" type="button" data-bs-toggle="modal"
                                        data-bs-target="#edit-modal-schema-{{ parent_index }}">
                                    <img class="img-edit" src="/static/images/icons8-editar-64.png">
                                </button>
                                <div class="modal modal-schemas fade" id="edit-modal-schema-{{ parent_index }}"
                                     tabindex="-1" aria-labelledby="edit-modal" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-centered modal-xl">
                                        <div class="modal-content">
                                            <div class="modal-body" id="edit-modal-body-schema-{{ parent_index }}">
                                                <div class="container">
                                                    <div class="container text-center">
                                                        <div class="row type-information">
                                                            <div class="col">
                                                                <h1 class="modal-edit-title" id="title-schema">
                                                                    Type{{ schema.name }}</h1>
                                                                <div class="form-atributes ">
                                                                    <form id="atributes-{{ parent_index }}"
                                                                          class="atributes">
                                                                        <!---Aquí se renderiza cada atributo del componente-->
                                                                        {% for atribute in schema.attributes %}
                                                                            <div id="atribute" class="atribute">
                                                                                <div class="atribute-checkbox-select d-flex justify-content-between align-items-center">
                                                                                    <div id="required"
                                                                                         class="checkbox-atribute">
                                                                                        <input class="form-check-input type-atribute"
                                                                                               type="checkbox" name=""
                                                                                               id="schema-{{ parent_index }}-atribute{{ loop.index }}"
                                                                                               checked>
                                                                                        <label id="name-attribute"
                                                                                               class="form-check-label"
                                                                                               for="schema-{{ parent_index }}-atribute{{ loop.index }}">{{ atribute.name }}</label>
                                                                                    </div>
                                                                                    <div class="form-floating-type">
                                                                                        <select class="form-select"
                                                                                                id="select-schema-{{ parent_index }}-atribute{{ loop.index }}"
                                                                                                aria-label="Floating label select example">
                                                                                            {% if atribute.type == 'integer' %}
                                                                                                <option value="integer"
                                                                                                        selected>integer
                                                                                                </option>
                                                                                                <option value="boolean">
                                                                                                    boolean
                                                                                                </option>
                                                                                                <option value="float">
                                                                                                    float
                                                                                                </option>
                                                                                                <option value="string">
                                                                                                    string
                                                                                                </option>
                                                                                            {% elif atribute.type == 'boolean' %}
                                                                                                <option value="integer">
                                                                                                    integer
                                                                                                </option>
                                                                                                <option value="boolean"
                                                                                                        selected>boolean
                                                                                                </option>
                                                                                                <option value="float">
                                                                                                    float
                                                                                                </option>
                                                                                                <option value="string">
                                                                                                    string
                                                                                                </option>
                                                                                            {% elif atribute.type == 'float' %}
                                                                                                <option value="integer">
                                                                                                    integer
                                                                                                </option>
                                                                                                <option value="boolean">
                                                                                                    boolean
                                                                                                </option>
                                                                                                <option value="float"
                                                                                                        selected>float
                                                                                                </option>
                                                                                                <option value="string">
                                                                                                    string
                                                                                                </option>
                                                                                            {% elif atribute.type == 'string' %}
                                                                                                <option value="integer">
                                                                                                    integer
                                                                                                </option>
                                                                                                <option value="boolean">
                                                                                                    boolean
                                                                                                </option>
                                                                                                <option value="float">
                                                                                                    float
                                                                                                </option>
                                                                                                <option value="string"
                                                                                                        selected>string
                                                                                                </option>
                                                                                            {% elif atribute.type == 'array' %}
                                                                                                <option value="integer">
                                                                                                    integer
                                                                                                </option>
                                                                                                <option value="boolean">
                                                                                                    boolean
                                                                                                </option>
                                                                                                <option value="float">
                                                                                                    float
                                                                                                </option>
                                                                                                <option value="string">
                                                                                                    string
                                                                                                </option>
                                                                                                <option value="{{ atribute.items_type }}"
                                                                                                        selected>
                                                                                                    array[{{ atribute.items_type }}]
                                                                                                </option>
                                                                                            {% else %}
                                                                                                <option value="{{ atribute.type }}"
                                                                                                        selected>{{ atribute.type }}</option>
                                                                                                <option value="integer">
                                                                                                    integer
                                                                                                </option>
                                                                                                <option value="boolean">
                                                                                                    boolean
                                                                                                </option>
                                                                                                <option value="float">
                                                                                                    float
                                                                                                </option>
                                                                                                <option value="string">
                                                                                                    string
                                                                                                </option>
                                                                                            {% endif %}
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="required-atribute ">
                                                                                    {% if atribute.required %}
                                                                                        <input class="form-check-input required"
                                                                                               type="checkbox" name=""
                                                                                               id="required-schema-{{ parent_index }}-atribute{{ loop.index }}"
                                                                                               checked>
                                                                                        <label class="form-check-label required-label"
                                                                                               id="required-label-schema-{{ parent_index }}-atribute{{ loop.index }}"
                                                                                               for="required-atribute1">Obligatorio</label>
                                                                                    {% else %}
                                                                                        <input class="form-check-input required"
                                                                                               type="checkbox" name=""
                                                                                               id="required-schema-{{ parent_index }}-atribute{{ loop.index }}">
                                                                                        <label class="form-check-label required-label"
                                                                                               id="required-label-schema-{{ parent_index }}-atribute{{ loop.index }}"
                                                                                               for="required-atribute1">Obligatorio</label>
                                                                                    {% endif %}
                                                                                </div>
                                                                            </div>
                                                                        {% endfor %}
                                                                    </form>
                                                                </div>
                                                                <div class="input-text-method-info">
                                                                    <input type="text" class="form-control schema-name"
                                                                           id="floatingInput-schema-{{ parent_index }}"
                                                                           placeholder="" value="{{ schema.name }}">
                                                                </div>
                                                            </div>
                                                            <div class="col">
                                                                <div class="form-floating">
                                                                    <textarea class="form-control"
                                                                              placeholder="Leave a comment here"
                                                                              id="floatingTextarea-schema-{{ parent_index }}"
                                                                              disabled></textarea>
                                                                    <label for="floatingTextarea-schema-{{ parent_index }}"></label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row" style="text-align: center !important;">
                                                            <div class="col">
                                                                <button class="save-button"
                                                                        onclick="toJS({{ parent_index }}, true)"
                                                                        type="button">Guardar
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>
                {% endfor %}
            </div>
            <div class="div-build-button" id="build-get">
                <button class="build-button" onclick="sentOpenAPI()" type="button">Construir</button>
            </div>
        </form>
    </div>
</div>

<div id="modal-loader" class="modal-loader">
    <div class="modal-loader-content">
        <div id="loader-icon" class="loader"></div>
        <span id="loader-text">Cargando...</span>
        <a class="build-button" id="downloak-link"></a>
    </div>
</div>

</body>
</html>


<script>

    let openApi = JSON.parse('{{ OpenAPI|tojson|safe }}')

    function toJS(index, other = false) {

        if (other) {
            charge(index);
            return 0;
        }

        changeSchema(openApi, index)
    }

</script>
